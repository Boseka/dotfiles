#!/usr/bin/zsh
# this file contains commands that will be executed when user is logged in
#
# Use a lockfile so that tmux does not execute these commands on creation of
# a new window.
LOCKFILE="/tmp/zprofile.lock"
if [[ ! -e $LOCKFILE ]]; then
    sudo ~/git/scripts/vgaoff
    source .zshrc
    bklt 35
    sudo modprobe vboxdrv
    sudo wicd

    echo -n "Loading X in 3 ... "
    read -t 1
    if [ $? -eq 1 ]; then
        echo -n "2 ... "
        read -t 1
        if [ $? -eq 1 ]; then
            echo -n "1 ... "
            read -t 1
            [ $? -eq 1 ] && startx
        fi
    fi
    touch $LOCKFILE
    [[ -z "$TMUX" ]] && exec tmux
fi